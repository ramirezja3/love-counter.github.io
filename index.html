<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Love Counter</title>
    <link rel="stylesheet" href="lc2.css">
    <link rel="icon" href="heart.webp" id="favicon">
</head>
<body>
    <h1>Click for Love</h1>
    <text class="left">Josh <span class="love">loves</span> you <span id="num1" class="num">0</span> times!</text>
    <text class="right">Chiquis <span class="love">loves</span> you <span id="num2" class="num">0</span> times!</text>
    <button class="jb" onclick="inc1()">
        <img src ="heart.webp" width=45% height=auto>
    </button>
    <button class="vb" onclick="inc2()">
        <img src ="heart.webp" width=45% height=auto>
    </button>
    <img id="leftimage" class="leftimage" src="monkey.png" width="18%" height="auto">
    <img id="rightimage" class="rightimage" src="bear.png" width="18%" height="auto">

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    

    <script>
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "firebase/app";
    import { getAnalytics } from "firebase/analytics";
    import { getFirestore, doc, updateDoc } from "firebase/firestore"; // Import Firestore functions
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
    apiKey: "AIzaSyDIMKLqaBqEvywchm6ERi30VbgLGVnMkfI",
    authDomain: "love-counter-995ab.firebaseapp.com",
    projectId: "love-counter-995ab",
    storageBucket: "love-counter-995ab.appspot.com",
    messagingSenderId: "677590602210",
    appId: "1:677590602210:web:abe8d9498dd8df31cba9bb",
    measurementId: "G-EFPSMS4H3G"
    };

    // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore(app);

        var x = 0;
        var y = 0;
        function inc1()
        {
            x++;
            document.getElementById("num1").textContent = x;
            resizeImages()
            // Update Firestore
            const loveCounterDocRef = doc(db, "loveCounter", "DQ8kk0tb9S5K9qHAPLVF"); 
            updateDoc(loveCounterDocRef, {
                joshLoves: x,
                chiquisLoves: y
            })
            .then(() => {
                console.log("Document successfully updated!");
            })
            .catch(error => {
                console.error("Error updating document: ", error);
            });
            }

        function inc2()
        {
            y++;
            document.getElementById("num2").textContent = y;
            resizeImages();
            // Update Firestore
            const loveCounterDocRef = doc(db, "loveCounter", "DQ8kk0tb9S5K9qHAPLVF"); 
            updateDoc(loveCounterDocRef, {
            joshLoves: x,
            chiquisLoves: y
        })
        .then(() => {
            console.log("Document successfully updated!");
        })
        .catch(error => {
                console.error("Error updating document: ", error);
            });
        }

        function resizeImages()
        {
            var total = x + y;
            var ratio_x = (x / total) + .5;
            var ratio_y = (y / total) + .5;
            document.getElementById("leftimage").style.transform = "scale(" + ratio_x.toFixed(2) + ")";
            document.getElementById("rightimage").style.transform = "scale(" + ratio_y.toFixed(2) + ")";
            updateFavicon()
        }

        function updateFavicon() 
        {
            if (x > y) 
            {
                favicon.href = "monkey.png";
            } 
            else if (y > x) 
            {
                favicon.href = "bear.png";
            }
            else
            {
                favicon.href = "heart.webp";
            }
        }

    </script>
</body> 
</html>